{"ast":null,"code":"// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../env-utils/assert.js\";\nconst workerURLCache = new Map();\n/**\n * Creates a loadable URL from worker source or URL\n * that can be used to create `Worker` instances.\n * Due to CORS issues it may be necessary to wrap a URL in a small importScripts\n * @param props\n * @param props.source Worker source\n * @param props.url Worker URL\n * @returns loadable url\n */\nexport function getLoadableWorkerURL(props) {\n  assert(props.source && !props.url || !props.source && props.url); // Either source or url must be defined\n  let workerURL = workerURLCache.get(props.source || props.url);\n  if (!workerURL) {\n    // Differentiate worker urls from worker source code\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n  assert(workerURL);\n  return workerURL;\n}\n/**\n * Build a loadable worker URL from worker URL\n * @param url\n * @returns loadable URL\n */\nfunction getLoadableWorkerURLFromURL(url) {\n  // A local script url, we can use it to initialize a Worker directly\n  if (!url.startsWith('http')) {\n    return url;\n  }\n  // A remote script, we need to use `importScripts` to load from different origin\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\n/**\n * Build a loadable worker URL from worker source\n * @param workerSource\n * @returns loadable url\n */\nfunction getLoadableWorkerURLFromSource(workerSource) {\n  const blob = new Blob([workerSource], {\n    type: 'application/javascript'\n  });\n  return URL.createObjectURL(blob);\n}\n/**\n * Per spec, worker cannot be initialized with a script from a different origin\n * However a local worker script can still import scripts from other origins,\n * so we simply build a wrapper script.\n *\n * @param workerUrl\n * @returns source\n */\nfunction buildScriptSource(workerUrl) {\n  return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}","map":{"version":3,"names":["assert","workerURLCache","Map","getLoadableWorkerURL","props","source","url","workerURL","get","getLoadableWorkerURLFromURL","set","getLoadableWorkerURLFromSource","startsWith","workerSource","buildScriptSource","blob","Blob","type","URL","createObjectURL","workerUrl"],"sources":["C:/Users/jakes/Documents/GitHub/duck-data-flask/duck-data-webpage/node_modules/@loaders.gl/worker-utils/dist/lib/worker-utils/get-loadable-worker-url.js"],"sourcesContent":["// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { assert } from \"../env-utils/assert.js\";\nconst workerURLCache = new Map();\n/**\n * Creates a loadable URL from worker source or URL\n * that can be used to create `Worker` instances.\n * Due to CORS issues it may be necessary to wrap a URL in a small importScripts\n * @param props\n * @param props.source Worker source\n * @param props.url Worker URL\n * @returns loadable url\n */\nexport function getLoadableWorkerURL(props) {\n    assert((props.source && !props.url) || (!props.source && props.url)); // Either source or url must be defined\n    let workerURL = workerURLCache.get(props.source || props.url);\n    if (!workerURL) {\n        // Differentiate worker urls from worker source code\n        if (props.url) {\n            workerURL = getLoadableWorkerURLFromURL(props.url);\n            workerURLCache.set(props.url, workerURL);\n        }\n        if (props.source) {\n            workerURL = getLoadableWorkerURLFromSource(props.source);\n            workerURLCache.set(props.source, workerURL);\n        }\n    }\n    assert(workerURL);\n    return workerURL;\n}\n/**\n * Build a loadable worker URL from worker URL\n * @param url\n * @returns loadable URL\n */\nfunction getLoadableWorkerURLFromURL(url) {\n    // A local script url, we can use it to initialize a Worker directly\n    if (!url.startsWith('http')) {\n        return url;\n    }\n    // A remote script, we need to use `importScripts` to load from different origin\n    const workerSource = buildScriptSource(url);\n    return getLoadableWorkerURLFromSource(workerSource);\n}\n/**\n * Build a loadable worker URL from worker source\n * @param workerSource\n * @returns loadable url\n */\nfunction getLoadableWorkerURLFromSource(workerSource) {\n    const blob = new Blob([workerSource], { type: 'application/javascript' });\n    return URL.createObjectURL(blob);\n}\n/**\n * Per spec, worker cannot be initialized with a script from a different origin\n * However a local worker script can still import scripts from other origins,\n * so we simply build a wrapper script.\n *\n * @param workerUrl\n * @returns source\n */\nfunction buildScriptSource(workerUrl) {\n    return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,QAAQ,wBAAwB;AAC/C,MAAMC,cAAc,GAAG,IAAIC,GAAG,CAAC,CAAC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,SAASC,oBAAoBA,CAACC,KAAK,EAAE;EACxCJ,MAAM,CAAEI,KAAK,CAACC,MAAM,IAAI,CAACD,KAAK,CAACE,GAAG,IAAM,CAACF,KAAK,CAACC,MAAM,IAAID,KAAK,CAACE,GAAI,CAAC,CAAC,CAAC;EACtE,IAAIC,SAAS,GAAGN,cAAc,CAACO,GAAG,CAACJ,KAAK,CAACC,MAAM,IAAID,KAAK,CAACE,GAAG,CAAC;EAC7D,IAAI,CAACC,SAAS,EAAE;IACZ;IACA,IAAIH,KAAK,CAACE,GAAG,EAAE;MACXC,SAAS,GAAGE,2BAA2B,CAACL,KAAK,CAACE,GAAG,CAAC;MAClDL,cAAc,CAACS,GAAG,CAACN,KAAK,CAACE,GAAG,EAAEC,SAAS,CAAC;IAC5C;IACA,IAAIH,KAAK,CAACC,MAAM,EAAE;MACdE,SAAS,GAAGI,8BAA8B,CAACP,KAAK,CAACC,MAAM,CAAC;MACxDJ,cAAc,CAACS,GAAG,CAACN,KAAK,CAACC,MAAM,EAAEE,SAAS,CAAC;IAC/C;EACJ;EACAP,MAAM,CAACO,SAAS,CAAC;EACjB,OAAOA,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,SAASE,2BAA2BA,CAACH,GAAG,EAAE;EACtC;EACA,IAAI,CAACA,GAAG,CAACM,UAAU,CAAC,MAAM,CAAC,EAAE;IACzB,OAAON,GAAG;EACd;EACA;EACA,MAAMO,YAAY,GAAGC,iBAAiB,CAACR,GAAG,CAAC;EAC3C,OAAOK,8BAA8B,CAACE,YAAY,CAAC;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,SAASF,8BAA8BA,CAACE,YAAY,EAAE;EAClD,MAAME,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACH,YAAY,CAAC,EAAE;IAAEI,IAAI,EAAE;EAAyB,CAAC,CAAC;EACzE,OAAOC,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASD,iBAAiBA,CAACM,SAAS,EAAE;EAClC,OAAO;AACX;AACA,mBAAmBA,SAAS;AAC5B;AACA;AACA;AACA,EAAE;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}