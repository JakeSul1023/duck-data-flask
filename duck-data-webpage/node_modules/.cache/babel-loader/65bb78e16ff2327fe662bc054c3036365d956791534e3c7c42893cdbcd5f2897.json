{"ast":null,"code":"// loaders.gl\n// SPDX-License-Identifier: MIT\n// Copyright (c) vis.gl contributors\nimport { Hash } from \"./hash.js\";\nimport CRC32C from \"./algorithms/crc32c.js\";\nimport { encodeNumber } from \"./utils/digest-utils.js\";\n/**\n * A transform that calculates CRC32c Hash\n */\nexport class CRC32CHash extends Hash {\n  name = 'crc32c';\n  options;\n  /**\n   * Atomic hash calculation\n   * @returns base64 encoded hash\n   */\n  constructor(options = {}) {\n    super();\n    this.options = {\n      crypto: {},\n      ...options\n    };\n  }\n  /**\n   * Atomic hash calculation\n   * @returns base64 encoded hash\n   */\n  async hash(input, encoding) {\n    return this.hashSync(input, encoding);\n  }\n  hashSync(input, encoding) {\n    const hash = new CRC32C(this.options);\n    hash.update(input);\n    const digest = hash.finalize();\n    return encodeNumber(digest, encoding);\n  }\n  // runInBatches inherited\n  async *hashBatches(asyncIterator, encoding = 'base64') {\n    const hash = new CRC32C(this.options);\n    for await (const chunk of asyncIterator) {\n      hash.update(chunk);\n      yield chunk;\n    }\n    const digest = hash.finalize();\n    this.options.crypto?.onEnd?.({\n      hash: encodeNumber(digest, encoding)\n    });\n  }\n}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}